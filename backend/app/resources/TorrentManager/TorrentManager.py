from app.resources.Common.Base import Base
from app.resources.TorrentManager.tor.main import Run

from .TorrentClient import TorrentClient
import asyncio
import logging


class TorrentManager(Base):

    # def __init__(self, path):
    #     self.path = path
    #     self.torrent = ''

    @staticmethod
    def manage(path):

        # main()
        # self.path = '/usr/src/backend/torrents/ubuntu-16.04-desktop-amd64.iso.torrent'
        # client = TorrentClient(path)
        loop = asyncio.new_event_loop()
        asyncio.set_event_loop(loop)
        logging.basicConfig(level=logging.INFO)
        run = Run(path)
        task = loop.create_task(run.connect())
        try:
            loop.run_until_complete(task)
        except Exception as e:
            print(e)
            return e

        # code = b"R|\xd4\xe1\xc8!\xb2 \xdc=\x1a\xe1R\xc1\x9f]\xf8\xb2N#\xe9J\xc3Pqt_>\xc8\xd5N8[E\xf0\x1e\xbb\xbc\x08\xe3\xe6\x8d.\xa6\xbf\x08\xc4\xc1%x,\r\xc8\xd5\xbcz\x02I\xc8\xd4R\xc4|WA\xf1WOz\xef\xc8\xd5.\xe6\xd2\x08\xd9\x08m\xc2\x03\x83\xd7\x84\x05\x14\xe2\x8a\xd0$\x92\xf7\x18\xb6\xdf\xc1\xbd\x06\xa8\x83#'Q\xf7\x83`\xc8\xd5Y\x0c\x91p\x1b\x1b\xc8D\x8a\x9f~r%\xde\xb2>m\xab\xae4l\xd7#'\x05\x934\xf1`\xcdTq|O\xc8\xd5B\x19\xf6\xb2\x1b3KZ\xa4N\xc8\xd5Z\xe7vf\xc8\xd6e\xbb\xd8\xa7\xf4\x00h\xf5O\xd5\x1a\xe5\x01\xb4\xeeI\xc8\xd5D1\xbd\x1b\x1a\xe1\xd4\x81>G\x852\x82\xef\x12\x9f\x1d}3\x0f4\x08\xc8\xd5\xbf\xb1\xb4\x93\xbf[W;\x8b\x1bA\xf1C\xdb\xe4\xc2\xcf\xa8\xbc\xa2\xe5/\xc8\xd5YCC\xae\x1a\xe1\xb9a\xc9J\xc8\xd5.2\xfe\xab\xc9\x16R\x1e\xc7\xba\xba2\xd9\xd3\xbet\xee\xb7\xd4\xb6Y\x0c\xc8\xd5k\xb5\xbdS\xaf\xda%0_\xa6\xb95Rf\x18\xfc\xc8\xd5\xb2\x13\xffD\x1a\xe1.0C\x92V\x0f>P\xe31\xc8\xd5"
        # res = code.decode('utf-8')
        # c = b"R|\xd4"
        # print([x for x in c])
        return "ok"
        # main(path)

